atlas {

  poller {

    # Set to a large value because we don't want it running during tests
    frequency = 60 minutes

    pollers = [
      {
        name = "cloudwatch"
        class = "com.netflix.atlas.cloudwatch.CloudWatchPoller"
      }
    ]
  }

  cloudwatch {
    testMode = false
    categories = ${?atlas.cloudwatch.categories} [
      "ut1",
      "ut5",
      "ut-asg",
      "ut-timeout",
      "ut-offset",
      "ut-mono",
      "ut-redis",
      "ut-daily",
      "queryfilter"
    ]

    account {
      polling = {
        default-regions = ["us-east-1", "us-west-2"]
        accounts = [
          {
            account = "000000000001"
          },
          {
            account = "000000000002"
          },
          {
            account = "000000000003"
            regions = ["us-east-1"]
          }
        ]
      }
      routing {
        uri = "https://publish-${STACK}.foo.com/api/v1/publish"
        default = "main"
        stackMap = {
          stackA = [
            "1",
            "2"
          ],
          stackB = [
            "3"
          ]
        }
      }
    }

    tagger = {
      common-tags = [
        {
          key = "nf.region"
          value = "us-west-2"
        }
      ]
    }
  }

}

include "test-rules.conf"